- title t(:".page_title")
- content_for :info do
  = t(:'.info')
- content_for :javascript do
  :plain
    $(document).ready(function(){
      dragable_options = { revert: true, stack: { group: 'photos', min: 50 }};
      $('.draggable').draggable(dragable_options);
      $('.droppable').droppable({
        drop: function(event, ui) {
          // when dropped onto website the update the photo and it's div
          photo_id = ui.draggable.attr('id');
          website_id = extractID(event.target.id);
          $.ajax({
            type: 'post',
            url: '/admin/photos/' + extractID(ui.draggable.attr('id')),
            data: 'action=edit&_method=put&photo[websites]['+website_id+']=1',
            success: function(html){
                $('#' + photo_id).replaceWith(html);
                $('#' + photo_id).draggable(dragable_options);
                deleteableWebsites($('#' + photo_id));
            }
          });
        }
      });
    });
    function deleteableWebsite(photo, website) {
    
    console.log(photo);
      delete_tag = document.createElement('a')
      delete_tag.appendChild(document.createTextNode('x'));
      delete_tag.bind('onclick', $.ajax({
        type: 'post',
        url: '/admin/photos/' + extractID(photo.attr('id')),
        data: 'action=edit&_method=put&photo[websites]['+website.attr('id')+']==',
        success: function(html){
            $('#' + photo.attr('id')).replaceWith(html);
            $('#' + photo.attr('id')).draggable(dragable_options);
        }
      }));
      console.log(delete_tag);
      $(website).append(delete_tag);
    }
    function deleteableWebsites(photo) {
    console.log($(photo).children('.info .websites')[0]);
      $(photo).children('.websites .website').each(function(index, website) {
        deleteableWebsite(photo,website);
      });
    }
    $('#photos .photo').each(function(index, photo) { deleteableWebsites(photo); });

- content_for :subnavigation do
  - if @website
    %li= link_to t(:'.new_album'), new_admin_website_album_path(@website)

- if ! @websites.nil? and @websites.empty?
  %h2= t(:'.websites')
  #websites
    = render :partial => 'website', :collection => @websites
- if ! @albums.nil? and @albums.empty?
  %h2= t(:'.albums')
  #albums
    = render :partial => 'album', :collection => @albums

%h2
  = t(:'.photos')
  = t(:".filtered_by_#{params[:filter]}") if params[:filter]
#photos
  = render :partial => 'photo', :collection => current_objects
= will_paginate current_objects
